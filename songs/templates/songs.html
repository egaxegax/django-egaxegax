{% extends 'base.html' %}
{% load i18n %}
{% block description %}{% if song_count %}. {% with songs.object_list|first as f %}{{ f.artist }}{% endwith %}{% endif %}, {% trans 'songs' %}, {% trans 'chords' %}{% endblock %}
{% block keywords %}{% if song_count %}, {% with songs.object_list|first as f %}{{ f.artist }}{% endwith %}{% endif %}, {% trans 'songs' %}, {% trans 'chords' %}{% endblock %}
{% block title %}
{% if song_count %}
  {% with songs.object_list|first as f %}{{ f.artist }}{% endwith %}
{% else %}
  {% trans 'Chords' %}
{% endif %}
 - {% trans 'songs' %}, {% trans 'chords' %} - {% endblock %}
{% block pagestyle %}
#topmenu li.songmenu { background-color: #E4E4E4; }
.indexlist { background-color: #D6D6D6; padding: 2px 8px; font-size: 70%; }
.messageitem { background-color: #E4E4E4; min-height: 1.5em; padding: 0 10px; margin: 2px; }
.messageitem dd { color: gray; }
{% endblock %}
{% block pageheader %}
{% if song_count %}
  {% with songs.object_list|first as f %}{{ f.artist }}{% endwith %}
{% else %}
  {% trans 'Chords' %}
{% endif %}
{% endblock %}
{% block content %}
<div class="indexlist">
  <a href="{% url songs.views.list_songs id_art=None %}">{% trans 'Full list' %}</a>
  {% for i, v in art_index.items %}
    <a class="nodecor" href="{% url songs.views.list_songs ind_art=i %}">{{ v|capfirst }}</a>
  {% endfor %}
</div>
<p>Подборы гитарных аккордов к песням. Читайте, слушайте, добавляйте свои подборы, тексты песен и музыку.</p>
{% if song_count %}
  <p>Найдено {% if art_count %}<b>{{ art_count }}</b> исполнителей и {% endif %}<b>{{ song_count }}</b> текстов.</p>
{% endif %}
{% if last_count %}
  <p>Последние обновления:</p>
{% endif %}
{% for song in songs.object_list %}
  <dl class="messageitem"><dt>
  {% if art_count or last_count %}
    <a href="{% url songs.views.list_songs id_art=song.id %}">{{ song.artist }}</a>
  {% endif %}
  {% if song.count %}
    <span class="smaller">[{{ song.count }}]</span>
  {% else %}
    <a class="nodecor" href="{% url songs.views.get_song id=song.id %}">{{ song.title|escape }}</a>
  {% endif %}
  {% if not art_count and song.audio %}
    <a class="nodecor" title="{% trans 'Listen' %}" href="{% url songs.views.get_song id=song.id %}?a=1"><sup> mp3</sup></a>
  {% endif %}
  </dt>
  {% if last_count %}
    <dd class="smaller">{{ song.date|timesince }} {% trans 'ago' %}</dd>
  {% endif %}
  </dl>
{% endfor %}
{% if songs.object_list %}
  <p class="smaller">
    {% if songs.has_previous %}
      <a href="?page={{ songs.previous_page_number }}">‹ {% trans 'previous' %}</a>
    {% endif %}
    {% if songs.paginator.num_pages > 1 %}
      <span class="current">
        {% trans 'Page' %} {{ songs.number }} {% trans 'of' %} {{ songs.paginator.num_pages }}
      </span>
    {% endif %}
    {% if songs.has_next %}
      <a href="?page={{ songs.next_page_number }}">{% trans 'next' %} ›</a>
    {% endif %}
  </p>
{% else %}
  <p>{% trans 'No songs' %}.</p>
{% endif %}
{% if user.is_authenticated %}
  <p class="smaller"><a href="{% url songs.views.add_song %}">{% trans 'Add song' %}</a></p>
{% else %}
  <p class="smaller">{% trans 'Please authorize to add songs' %}.</p>
{% endif %}
{% endblock %}
